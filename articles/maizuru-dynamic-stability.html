<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compute Dynamic Stability for the Maizuru Bay Fish Community • portalDS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Compute Dynamic Stability for the Maizuru Bay Fish Community">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">portalDS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/maizuru-dynamic-stability.html">Compute Dynamic Stability for the Maizuru Bay Fish Community</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Compute Dynamic Stability for the Maizuru Bay Fish Community</h1>
                        <h4 class="author">Hao Ye</h4>
            
            <h4 class="date">2019-01-07</h4>
      
      
      <div class="hidden name"><code>maizuru-dynamic-stability.Rmd</code></div>

    </div>

    
    
<div id="intro-look-at-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#intro-look-at-the-data" class="anchor"></a>Intro Look at the Data</h2>
<p>This document demonstrates the dynamic stability analysis for the Maizuru Bay fish community. First, we load in the data and take a look at the time series for the fish populations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(portalDS)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; Registered S3 methods overwritten by 'ggplot2':</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt;   method         from </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt;   [.quosures     rlang</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;   c.quosures     rlang</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;   print.quosures rlang</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(maizuru_block)</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw"><a href="../reference/plot_time_series.html">plot_time_series</a></span>(maizuru_block) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="st">    </span><span class="co"># scale_x_date(limits = as.Date(c("2005-03-01", "2011-01-01")),</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="st">    </span><span class="co">#              date_breaks = "1 year", date_labels = "%Y", expand = c(0.01, 0)) +</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span>(<span class="dt">color =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="maizuru-dynamic-stability_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div id="dynamic-stability-calculations" class="section level2">
<h2 class="hasAnchor">
<a href="#dynamic-stability-calculations" class="anchor"></a>Dynamic Stability Calculations</h2>
<p>Do the dynamic stability analysis for the maizuru system. The steps involved in the full analysis are:</p>
<ol style="list-style-type: decimal">
<li>run simplex projection on each time series to identify the optimal embedding dimension</li>
<li>generate surrogate time series, assumming that the data have just a seasonal pattern</li>
<li>run ccm on each pairwise interaction, including the surrogate data</li>
<li>identify the significant interactions by comparing the CCM for the real time series against the calculations for the surrogate data</li>
<li>run S-map models for each time series, using the appropriate number of lags, and including the important interacting variables</li>
<li>extract out the s-map coefficients from the models and assemble matrices for the system</li>
<li>perform eigen-decomposition on the s-map coefficient matrices</li>
</ol>
<p>We also need to specify an output file – the <code>compute_dynamic_stability</code> function saves intermediate results in that file, which allows us to do calculations across multiple sessions. This can be useful because of the time required to do CCM calculations for all of the surrogates.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">results_file &lt;-<span class="st"> </span>here<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"output/maizuru_ds_results.RDS"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="../reference/compute_dynamic_stability.html">compute_dynamic_stability</a></span>(maizuru_block, results_file, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">                          <span class="dt">surrogate_method =</span> <span class="st">"twin"</span>, </a>
<a class="sourceLine" id="cb2-5" data-line-number="5">                          <span class="dt">max_E =</span> <span class="dv">24</span>, </a>
<a class="sourceLine" id="cb2-6" data-line-number="6">                          <span class="dt">num_surr =</span> <span class="dv">200</span>, </a>
<a class="sourceLine" id="cb2-7" data-line-number="7">                          <span class="dt">surr_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">T_period =</span> <span class="dv">24</span>, </a>
<a class="sourceLine" id="cb2-8" data-line-number="8">                                             <span class="dt">quantile_vec =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.875</span>, <span class="fl">0.88</span>, <span class="fl">0.89</span>, <span class="fl">0.90</span>, <span class="fl">0.91</span>, <span class="fl">0.92</span>, </a>
<a class="sourceLine" id="cb2-9" data-line-number="9">                                                              <span class="fl">0.93</span>, <span class="fl">0.94</span>, <span class="fl">0.95</span>, <span class="fl">0.85</span>, <span class="fl">0.84</span>, <span class="fl">0.83</span>, </a>
<a class="sourceLine" id="cb2-10" data-line-number="10">                                                              <span class="fl">0.82</span>, <span class="fl">0.81</span>, <span class="fl">0.80</span>, <span class="fl">0.96</span>))</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">)</a></code></pre></div>
</div>
<div id="plot-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-outputs" class="anchor"></a>Plot outputs</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">## plot network ----</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">my_graph &lt;-<span class="st"> </span>results<span class="op">$</span>ccm_links <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(lib_column <span class="op">!=</span><span class="st"> </span>target_column) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(target_column) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(target_column, lib_column) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">  </span><span class="kw">graph_from_data_frame</span>(<span class="dt">vertices =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/levels">levels</a></span>(.<span class="op">$</span>target_column))</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">palette &lt;-<span class="st"> </span><span class="kw">viridis</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw">V</span>(my_graph)))</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(palette) &lt;-<span class="st"> </span><span class="kw">as_ids</span>(<span class="kw">V</span>(my_graph))</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">my_graph &lt;-<span class="st"> </span><span class="kw">create_layout</span>(my_graph, <span class="dt">layout =</span> layout)</a>
<a class="sourceLine" id="cb3-13" data-line-number="13"></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">maizuru_network &lt;-<span class="st"> </span><span class="kw">ggraph</span>(my_graph) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_edge_fan</span>(<span class="dt">edge_width =</span> <span class="dv">1</span>, <span class="dt">start_cap =</span> <span class="kw">circle</span>(<span class="fl">0.3</span>, <span class="st">"inches"</span>),</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">                <span class="dt">end_cap =</span> <span class="kw">circle</span>(<span class="fl">0.3</span>, <span class="st">"inches"</span>),</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">                <span class="dt">arrow =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">arrow</a></span>(<span class="dt">angle =</span> <span class="dv">20</span>, <span class="dt">type =</span> <span class="st">"closed"</span>,</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">                              <span class="dt">length =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_node_circle</span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">r =</span> <span class="fl">0.08</span>, <span class="dt">fill =</span> name)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="st">  </span><span class="kw">theme_graph</span>(<span class="dt">foreground =</span> <span class="st">"black"</span>, <span class="dt">fg_text_colour =</span> <span class="st">"white"</span>,</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">              <span class="dt">background =</span> <span class="st">"transparent"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">text =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">family =</span> <span class="st">"Helvetica"</span>),</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">        <span class="dt">panel.border =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(<span class="dt">color =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="ot">NA</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="dt">values =</span> palette) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span>(<span class="dt">fill =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span>(<span class="dt">title =</span> <span class="st">"Species"</span>))</a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span>(here<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"figures/maizuru_network.pdf"</span>),</a>
<a class="sourceLine" id="cb3-28" data-line-number="28">       maizuru_network, <span class="dt">width =</span> <span class="dv">8</span>, <span class="dt">height =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb3-29" data-line-number="29"></a>
<a class="sourceLine" id="cb3-30" data-line-number="30">## plot subset of time series ----</a>
<a class="sourceLine" id="cb3-31" data-line-number="31">sp_list &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Rudarius.ercodes"</span>, <span class="st">"Trachurus.japonicus"</span>)</a>
<a class="sourceLine" id="cb3-32" data-line-number="32">palette &lt;-<span class="st"> </span><span class="kw">viridis</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">NCOL</a></span>(block)<span class="op">-</span><span class="dv">1</span>)[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/match">match</a></span>(sp_list, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(block, <span class="op">-</span>censusdate))))]</a>
<a class="sourceLine" id="cb3-33" data-line-number="33">maizuru_time_series_subset &lt;-</a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(block, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"censusdate"</span>, sp_list)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="st">  </span><span class="kw"><a href="../reference/plot_time_series.html">plot_time_series</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span>(<span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"2005-03-01"</span>, <span class="st">"2011-01-01"</span>)),</a>
<a class="sourceLine" id="cb3-37" data-line-number="37">               <span class="dt">date_breaks =</span> <span class="st">"1 year"</span>, <span class="dt">date_labels =</span> <span class="st">"%Y"</span>, <span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values =</span> palette) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span>(<span class="dt">color =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>species, <span class="dt">ncol =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-41" data-line-number="41"></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span>(here<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"figures/maizuru_time_series_subset.pdf"</span>),</a>
<a class="sourceLine" id="cb3-43" data-line-number="43">       maizuru_time_series_subset, <span class="dt">width =</span> <span class="dv">9</span>, <span class="dt">height =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb3-44" data-line-number="44"></a>
<a class="sourceLine" id="cb3-45" data-line-number="45">## plot subset of network ----</a>
<a class="sourceLine" id="cb3-46" data-line-number="46">existing_graph &lt;-<span class="st"> </span>my_graph <span class="co"># save old graph layout</span></a>
<a class="sourceLine" id="cb3-47" data-line-number="47"></a>
<a class="sourceLine" id="cb3-48" data-line-number="48">my_graph &lt;-<span class="st"> </span>results<span class="op">$</span>ccm_links <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-49" data-line-number="49"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(lib_column <span class="op">!=</span><span class="st"> </span>target_column) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-50" data-line-number="50"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(target_column) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-51" data-line-number="51"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(target_column, lib_column) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-52" data-line-number="52"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(target_column <span class="op">%in%</span><span class="st"> </span>sp_list, lib_column <span class="op">%in%</span><span class="st"> </span>sp_list) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53"><span class="st">  </span><span class="kw">graph_from_data_frame</span>()</a>
<a class="sourceLine" id="cb3-54" data-line-number="54"></a>
<a class="sourceLine" id="cb3-55" data-line-number="55">my_graph &lt;-<span class="st"> </span><span class="kw">create_layout</span>(my_graph, <span class="dt">layout =</span> layout)</a>
<a class="sourceLine" id="cb3-56" data-line-number="56">idx &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/match">match</a></span>(my_graph<span class="op">$</span>name, existing_graph<span class="op">$</span>name)</a>
<a class="sourceLine" id="cb3-57" data-line-number="57">my_graph<span class="op">$</span>x &lt;-<span class="st"> </span>existing_graph<span class="op">$</span>x[idx]</a>
<a class="sourceLine" id="cb3-58" data-line-number="58">my_graph<span class="op">$</span>y &lt;-<span class="st"> </span>existing_graph<span class="op">$</span>y[idx]</a>
<a class="sourceLine" id="cb3-59" data-line-number="59"></a>
<a class="sourceLine" id="cb3-60" data-line-number="60">maizuru_network_subset &lt;-<span class="st"> </span><span class="kw">ggraph</span>(my_graph) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-61" data-line-number="61"><span class="st">  </span><span class="kw">geom_edge_fan</span>(<span class="dt">edge_width =</span> <span class="dv">1</span>, <span class="dt">start_cap =</span> <span class="kw">circle</span>(<span class="fl">0.3</span>, <span class="st">"inches"</span>),</a>
<a class="sourceLine" id="cb3-62" data-line-number="62">                <span class="dt">end_cap =</span> <span class="kw">circle</span>(<span class="fl">0.3</span>, <span class="st">"inches"</span>),</a>
<a class="sourceLine" id="cb3-63" data-line-number="63">                <span class="dt">arrow =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">arrow</a></span>(<span class="dt">angle =</span> <span class="dv">20</span>, <span class="dt">type =</span> <span class="st">"closed"</span>,</a>
<a class="sourceLine" id="cb3-64" data-line-number="64">                              <span class="dt">length =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-65" data-line-number="65"><span class="st">  </span><span class="kw">geom_node_circle</span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">r =</span> <span class="fl">0.08</span>, <span class="dt">fill =</span> name)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-66" data-line-number="66"><span class="st">  </span><span class="kw">theme_graph</span>(<span class="dt">foreground =</span> <span class="st">"black"</span>, <span class="dt">fg_text_colour =</span> <span class="st">"white"</span>,</a>
<a class="sourceLine" id="cb3-67" data-line-number="67">              <span class="dt">background =</span> <span class="st">"transparent"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-68" data-line-number="68"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-69" data-line-number="69"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">text =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">family =</span> <span class="st">"Helvetica"</span>),</a>
<a class="sourceLine" id="cb3-70" data-line-number="70">        <span class="dt">panel.border =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(<span class="dt">color =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="ot">NA</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-71" data-line-number="71"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="dt">values =</span> palette) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-72" data-line-number="72"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span>(<span class="dt">fill =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span>(<span class="dt">title =</span> <span class="st">"Species"</span>))</a>
<a class="sourceLine" id="cb3-73" data-line-number="73"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span>(here<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"figures/maizuru_network_subset.pdf"</span>),</a>
<a class="sourceLine" id="cb3-74" data-line-number="74">       maizuru_network_subset, <span class="dt">width =</span> <span class="dv">8</span>, <span class="dt">height =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb3-75" data-line-number="75"></a>
<a class="sourceLine" id="cb3-76" data-line-number="76">## plot eigenvalues ----</a>
<a class="sourceLine" id="cb3-77" data-line-number="77">ds_plot &lt;-<span class="st"> </span>results<span class="op">$</span>eigenvalues <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-78" data-line-number="78"><span class="st">  </span><span class="kw"><a href="../reference/plot_eigenvalues.html">plot_eigenvalues</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-79" data-line-number="79"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-80" data-line-number="80"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span>(<span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"2005-03-01"</span>, <span class="st">"2011-01-01"</span>)),</a>
<a class="sourceLine" id="cb3-81" data-line-number="81">               <span class="dt">date_breaks =</span> <span class="st">"1 year"</span>, <span class="dt">date_labels =</span> <span class="st">"%Y"</span>, <span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.01</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb3-82" data-line-number="82"></a>
<a class="sourceLine" id="cb3-83" data-line-number="83"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span>(here<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"figures/maizuru_ds_blank.pdf"</span>),</a>
<a class="sourceLine" id="cb3-84" data-line-number="84">       ds_plot, <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb3-85" data-line-number="85"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span>(here<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"figures/maizuru_ds_threshold.pdf"</span>),</a>
<a class="sourceLine" id="cb3-86" data-line-number="86">       ds_plot <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="fl">1.0</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb3-87" data-line-number="87">       <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb3-88" data-line-number="88"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span>(here<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"figures/maizuru_ds.pdf"</span>),</a>
<a class="sourceLine" id="cb3-89" data-line-number="89">       ds_plot <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values =</span> <span class="st">"black"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-90" data-line-number="90"><span class="st">         </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="fl">1.0</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb3-91" data-line-number="91">       <span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="dv">5</span>)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#intro-look-at-the-data">Intro Look at the Data</a></li>
      <li><a href="#dynamic-stability-calculations">Dynamic Stability Calculations</a></li>
      <li><a href="#plot-outputs">Plot outputs</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hao Ye.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
